# Приложение для анализа температурных данных и мониторинг текущей температуры через OpenWeatherMap API


Готовое приложение доступно по ссылке: [приложение](https://appapptemperature-mqrlpxlrud8lc86dclvz7z.streamlit.app/)

**Данные** сгенерированы случайным образом, содержат 4 колонки и 54750 строк.  
Колонки: город, дата, температура, сезон.  
**стек:** `pandas`, `streamlit`, `LinearRegression`, `multiprocessing`, `asyncio`, `aiohttp`, `requests`, `matplotlib`

<img width="396" alt="image" src="https://github.com/user-attachments/assets/553b0541-497b-4ded-bea4-b1ca5b0d6a0c" />

**Анализ исторических данных**:
   - Вычислить **скользящее среднее** температуры с окном в 30 дней для сглаживания краткосрочных колебаний.
   - Рассчитать среднюю температуру и стандартное отклонение для каждого сезона в каждом городе.
   - Выявить аномалии, где температура выходит за пределы $ \text{среднее} \pm 2\sigma $.
   - Попробуйте распараллелить проведение этого анализа. Сравните скорость выполнения анализа с распараллеливанием и без него.
  
  В файле `analysis.py` с помощью функции `main_analysis` расчитываются скользящие, максимум, минимум, среднее, профиль по температурам,  профили по скользящим, список аномальных точек, тренд.  
  Функция запускается в 2-х режимах с распараллеливанием расчетов по городами без.

С использованием multiprocessing Pool время применения функции более длительное:
0.24 без мультипроцессинга
1.68 с мультипроцессингом

![image](https://github.com/user-attachments/assets/22c62feb-c82d-4c92-8974-ee39c05f51c8)



2. **Мониторинг текущей температуры**:
   - Подключить OpenWeatherMap API для получения текущей температуры города. Для получения API Key (бесплатно) надо зарегистрироваться на сайте. Обратите внимание, что API Key может активироваться только через 2-3 часа, это нормально. Посему получите ключ заранее.
   - Получить текущую температуру для выбранного города через OpenWeatherMap API.
   - Определить, является ли текущая температура нормальной, исходя из исторических данных для текущего сезона.
   - Данные на самом деле не совсем реальные (сюрпрайз). Поэтому на момент эксперимента погода в Берлине, Каире и Дубае была в рамках нормы, а в Пекине и Москве аномальная. Протестируйте свое решение для разных городов.
   - Попробуйте для получения текущей температуры использовать синхронные и асинхронные методы. Что здесь лучше использовать?
  
   В файлах `monitoting.py`  и  `monitoring_async.py` был выполнен запрос текущей температуры с ресурса OpenWeatherMap и сравнение с профилем сезона для города, далее проведен анализ текущего значения температуры на аномальность. Было выполнено два вариант синхронным методом с помощью `requests` и асинхронным `aiohttp & asyncio`.

Вывод: время выполнения с асинхронностью и без примерно одинаковое.  В данном случае нет большой необходимости использовать асинхронные соединения, так как HTTP запросов к сайту довольно мало? а также запросы методом request выполняются довольно быстро.

Результат выполнения без асинхронности:
<img width="731" alt="image" src="https://github.com/user-attachments/assets/406a7816-610d-40aa-9478-eca2089b065e" />



Результат выполнения с асинхронностью:
<img width="725" alt="image" src="https://github.com/user-attachments/assets/1710fab8-53c3-4c73-ad8b-9c4bb3435ba0" />



4. **Создание приложения на Streamlit**:
   - Добавить интерфейс для загрузки файла с историческими данными.
   - Добавить интерфейс для выбора города (из выпадающего списка).
   - Добавить форму для ввода API-ключа OpenWeatherMap. Когда он не введен, данные для текущей погоды не показываются. Если ключ некорректный, выведите на экран ошибку (должно приходить `{"cod":401, "message": "Invalid API key. Please see https://openweathermap.org/faq#error401 for more info."}`).
   - Отобразить:
     - Описательную статистику по историческим данным для города, можно добавить визуализации.
     - Временной ряд температур с выделением аномалий (например, точками другого цвета).
     - Сезонные профили с указанием среднего и стандартного отклонения.
   - Вывести текущую температуру через API и указать, нормальна ли она для сезона.
  
   Код приложения находится в файле `app.py`, ссылка на приложение [https://appapptemperature-mqrlpxlrud8lc86dclvz7z.streamlit.app/](https://appapptemperature-mqrlpxlrud8lc86dclvz7z.streamlit.app/)

   Интерфейс приложения:

   <img width="772" alt="image" src="https://github.com/user-attachments/assets/87d1776d-cdc8-42bd-9316-0e71f522afdd" />


   <img width="736" alt="image" src="https://github.com/user-attachments/assets/1b01a5f1-af22-4003-9745-e86cc7455b37" />

   <img width="753" alt="image" src="https://github.com/user-attachments/assets/73953aa6-f319-4a01-be0a-eeccbb3d7d06" />

<img width="713" alt="image" src="https://github.com/user-attachments/assets/4e240b95-dc75-4ce6-91d8-ce4ec4d747ff" />



